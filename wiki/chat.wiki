#summary Обмен короткими сообщениями (чат)

<h1>Distributed Network Messaging Protocol</h1>

Коммерческое использование только с разрешения автора.<br>
При использовании необходимо явно указывать ссылку на источник.

<p>Sergey Bodrov, 2014-07-21</p>

<h1>Сервис CHAT</h1>

<p>Сервис CHAT предназначен для обмен короткими (до 1Кбайт) сообщениями между пользователями. Сообщения могут быть как текстовыми, так и мультимедийными (звук, видео). Также возможна оргранизация независимого сеанса связи между абонентами, при этом сообщения CHAT играют роль "служебного" канала связи.</p>

Сообщение содержит:<br>
<li>дату-время создания
<li>имя автора
<li>GUID автора
<li>имя получателя
<li>GUID получателя
<li>формат сообщения
<li>текст сообщения

<h2>Формат сообщений DNMP</h2>

<u>Обязательные реквизиты для всех сообщений</u><br>
Тип: <b>CHAT</b><br>
Параметры:<br>
<b>timestamp</b> - таймштамп сообщения<br>
<b>author_name</b> - имя автора сообщения<br>
<b>author_guid</b> - GUID автора сообщения<br>
<b>target_name</b> - имя получателя сообщения<br>
<b>target_guid</b> - GUID получателя сообщения<br>
<b>cmd</b> - команда<br>

<h3>Команды:</h3>

<b>MSG</b><br>
Отправка короткого текстового сообщения.<br>
(сервер, клиент) Если абонент в "черном списке", то возвращаем отказ.<br>
<br>
Параметры:<br>
cmd=MSG<br>
req - требуется отчет о доставке
<br>
Данные:<br>
Текст сообщения<br>

<b>INVITE</b><br>
Вызов абонента, приглашение начать беседу. В ответ вызываемый абонент присылает согласие (ACK) или отказ (BYE). В параметрах может быть указан формат беседы - голосовая, видео, итд.. По умолчанию текстовый формат.<br>
(сервер, клиент) Если абонент в "черном списке", то возвращаем отказ.<br>
<br>
Параметры:<br>
cmd=INVITE<br>
<br>
Данные:<br>
Текст сообщения приглашения<br>


<b>ACK</b><br>
Прием вызова абонента, начало беседы. В параметрах может быть указан формат беседы - голосовая, видео, итд.. По умолчанию текстовый формат.<br>
<br>
Параметры:<br>
cmd=ACK<br>
<br>
Данные:<br>
Текст сообщения приветствия<br>


<b>BYE</b><br>
Отказ вызова абонента, завершение беседы.<br>
<br>
Параметры:<br>
cmd=BYE<br>
<br>
Данные:<br>
Текст описания отказа<br>
